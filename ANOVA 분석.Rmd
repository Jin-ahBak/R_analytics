---
title: "ANOVA"
author: "박진아"
date: '2021 4 23 '
output: html_document
---
### ANOVA - 독립변수의 범주수가 3개 이상의 집단 분석 - 일원분석1 

독립변수: 시도별 진보 지지율에 따른 3개의 집단
연속변수: 범죄율 
Ho(귀무가설) : 시도별 진보 지지율 정도에 따라 범죄율의 차이가 없다.   
H1(대립가설) : 시도별 진보 지지율 정도에 따라 범죄율의 차이가 있다.

#### 정규성 검정  

표본크기 10~30 : 정규성 검정 후 결정  
범죄률 샘플사이즈: 17개 

H0 (귀무가설) : 정규분포를 따른다.
H1 (대립가설) : 정규분포를 따르지 않는다.
```{r}
shapiro.test(핵심_데이터$범죄_data)  
```
<결과>
P-value 값 0.00005394 < 유의수준 0.05 보다 작기 때문에 대립가설을 채택할 수 있다. 따라서 범죄율 데이터는 정규분포를 따른다고 할 수 없다. 

#### 분산 동질성 검증  
H0 (귀무가설): 지지율 정도에 따른 세 집단의 범죄율 분산이 같다 =  범죄율 분산비율이 1이다.  
H1 (대립가설) : 지지율 정도에 따른 세 집단의 범죄율 분산이 다르다 = 범죄율 분산비율이 1이 아니다.

#### 등분산성 검증- 정규분포를 벗어나도 사용가능한 FK test 
```{r}
fligner.test(범죄_data ~ data, data = 핵심_데이터)
```
<분산 동질성 검정결과>  
p-value = 0.7406 >유의수준 0.05보다 크기떄문에 귀무가설을 기각할 수 없다.  따라서 세 집단의 범죄율 분산이 동일하다는 것을 알 수 있다. 세 집단의 분산이 같다는 가정으로 ANOVA를 수행할 것이다.  


#### 등분산성 검증- 정규분포를 어느정도 벗어나도 사용가능 L test
```{r}
library(car)  
leveneTest(범죄_data~ data, data=핵심_데이터 )
```
<결과> 
정규성 분포를 따르지 않기 떄문에 Fligner-Killeen test와 leveneTest 모두 확인해 본 결과, leveneTest 또한 p-value값이 0.05 수준보다 높게 나오면서 분산이 동일하다는 같은 결과가 도출되었다.   

#### 등분산성 검증 만족- 일원 분산분석의 분석방법 

독립변수: 진보당 지지율에 따른 3개의 집단
연속변수: 범죄율 
Ho(귀무가설) : 시도별 진보당 지지율 정도에 따라 범죄율의 차이가 없다.   
H1(대립가설) : 시도별 진보당 지지율 정도에 따라 범죄율의 차이가 있다.
```{r}
anov1 <- aov(범죄_data ~ data, data=핵심_데이터)  
anova(anov1)

```
<결과>
P-value 값 0.7594 > 유의수준 0.05 보다 크기 때문에 대립가설을 채택할 수 없다. 따라서 시도별 진보당 지지율 정도에 따라 범죄율의 차이가 없다.

#### 등분산성 검증 만족- 사후검증 ( anova결과 차이가 없다는 결론을 얻었지만, 사후검증을 통해 확인하기)
```{r}
library(agricolae)  
scheffe.test(anov1, "data", alpha = 0.05 , console=TRUE)  
```
<사후검증 결과>
3집단의 평균 모두 유의한 차이가 없기 때문에 집단 a로 동일하다. 즉, 시도별 진보당 지지율 정도에 따라 범죄율의 차이가 없다는 것을 확실히 알 수 있다.    

### ANOVA - 독립변수의 범주수가 3개 이상의 집단 분석 - 일원분석2

독립변수: 시도별 진보 지지율에 따른 3개의 집단
연속변수: 자살률
Ho(귀무가설) : 시도별 진보당 지지율 정도에 따라 자살률의 차이가 없다.   
H1(대립가설) : 시도별 진보당 지지율 정도에 따라 자살률의 차이가 있다.

#### 정규성 검정  

표본크기 10~30 : 정규성 검정 후 결정  
범죄률 샘플사이즈: 17개 

H0 (귀무가설) : 정규분포를 따른다.
H1 (대립가설) : 정규분포를 따르지 않는다.
```{r}
shapiro.test(핵심_데이터$자살_data)
```
<정규성 검정결과>
P-value 값 0.1993 > 유의수준 0.05 보다 크기 때문에 대립가설을 채택할 수 없다. 따라서 자살률 데이터는 정규분포를 따른다는 것을 알 수 있다.  

#### 분산 동질성 검증  
H0 (귀무가설): 지지율 정도에 따른 세 집단의 자살률 분산이 같다 =  자살률 분산비율이 1이다.  
H1 (대립가설) : 지지율 정도에 따른 세 집단의 자살률 분산이 다르다 = 자살률  분산비율이 1이 아니다.
```{r}
leveneTest(자살_data~ data, data=핵심_데이터 )
```
<분산 동질성 검정결과>  
p-value = 0.2575 >유의수준 0.05보다 크기떄문에 대립가설을 채택할 수 없다.    따라서 세 집단의 자살률 분산이 동일하다는 것을 알 수 있다. 세 집단의 분산이 같다는 가정으로 ANOVA를 수행할 것이다.  

#### 등분산성 검증 만족- 일원 분산분석의 분석방법  

독립변수: 지지율에 따른 3개의 집단
연속변수: 자살률
Ho(귀무가설) : 시도별 진보당 지지율 정도에 따라 자살률의 차이가 없다.   
H1(대립가설) : 시도별 진보당 지지율 정도에 따라 자살률의 차이가 있다.
```{r}
anova2 <-oneway.test(자살_data ~ data, data= 핵심_데이터 , var.equal=T)
```
<결과>
P-value 값 0.05329 > 유의수준 0.05 보다 크기 때문에 대립가설을 채택할 수 없다. 따라서 시도별 진보당 지지율 정도에 따라 자살률의 차이가 없다.
  

#### 등분산성 검증 만족- 사후검증 ( anova결과 차이가 없다는 결론을 얻었지만, 사후검증을 통해 확인하기)
```{r}
scheffe.test(anov2, "data", alpha = 0.05 , console=TRUE)  
```
<사후검증 결과>
3집단의 평균 모두 유의한 차이가 없기 때문에 집단 a로 동일하다. 즉, 시도별 보수당 지지율 정도에 따라 자살률의 차이가 없다는 것을 확실히 알 수 있다. 


